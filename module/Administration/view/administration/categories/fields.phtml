
<div class="modal-body">
	<?php if(count($this->fields)>0){?>
	<table class="table table-striped">
		<thead>
			<tr>
				<th>id</th>
				<th>Nom</th>
				<th>Type</th>
                <th>Multiple</th>
				<th>Défaut</th>
                <th>Aide</th>
				<th data-container="body" data-toggle="tooltip" title="Tracer les changements dans le compte-rendu IPO">Trace<sup>?</sup></th>
				<th> </th>
				<th><a href="#" data-id="<?php echo $this->categoryid; ?>" class="btn btn-xs btn-primary" id="new-field">Ajouter</a></th>
			</tr>
		</thead>
		<tbody>
		<?php 
		$i = 1;
		$total = count($fields);
		foreach ($fields as $field){
			//Warning : table is also generated by jquery, don't forget to apply modifications there too
			echo "<tr>";
			echo "<td>".$field->getId()."</td>";
			echo "<td>".$field->getName()."</td>";
			echo "<td>".$field->getType()->getName()."</td>";
            echo "<td>";
                if(!$this->isMultipleAllowed($field)){
                    echo '<span class="glyphicon glyphicon-grey icon-remove"></span>';
                } else {
                    if($field->isMultiple()){
                        echo '<span class="glyphicon glyphicon-ok"></span>';
                    } else {
                        echo '<span class="glyphicon glyphicon-remove"></span>';
                    }
                }                        
            echo "</td>";
			echo "<td>".nl2br($field->getDefaultValue())."</td>";
			echo "<td>".$field->getTooltip()."</td>";
			echo "<td>";
				if($field->isTraceable()){
					echo '<span class="glyphicon glyphicon-ok"></span>';
				} else {
					echo '<span class="glyphicon glyphicon-remove"></span>';
				}
			echo "</td>";
			echo "<td>";
				echo "<a href=\"".$this->url('administration', array('controller'=>'fields', 'action'=>'fieldup'))."?id=".$field->getId()."\" class=\"up".($i==1?" disabled\"":"\"")."><span class=\"up-caret middle\"></span></a> ";
				echo "<a href=\"".$this->url('administration', array('controller'=>'fields', 'action'=>'fielddown'))."?id=".$field->getId()."\" class=\"down".($i==$total?" disabled\"":"\"")."><span class=\"caret middle\"></span></a>";
			echo "</td>";
			echo "<td>";
			echo "<a href=\"#\"
					class=\"mod-field\" 
					data-id=\"".$field->getId()."\" 
					data-name=\"".$field->getName()."\"><span class=\"glyphicon glyphicon-pencil\"></span></a> ";
			echo "<a href=\"#confirm-delete-field\" 
					data-href=\"".$this->url('administration', 
											array('controller'=>'fields', 'action'=>'delete'),
											array('query'=>array('id'=>$field->getId())))."\" 
					class=\"delete-field\" 
					data-id=\"".$field->getId()."\" 
					data-name=\"".$field->getName()."\" 
					data-toggle=\"modal\"><span class=\"glyphicon glyphicon-trash\"></span> </a>";
			echo "</td>";
			echo "</tr>";
			$i++;
		}
		?>
		<tr id="add-field"></tr>
		</tbody>
	</table>
	<?php } else {?>
	<p>Aucun champ spécifique à cette catégorie : <a href="#" data-id="<?php echo $this->categoryid; ?>" class="btn btn-xs btn-primary" id="new-field">Ajouter</a></p>
	<table class="table table-striped">
	<tbody>
		<tr id="add-field"></tr>
	</tbody>
	</table>
	<?php }?>
<?php 
?>
</div>

<div class="modal-footer">
	<a href="<?php echo $this->url('administration', array('controller'=>'categories')); ?>" class="btn btn-primary">Terminer</a> 
<!-- <a id="cancel-form" class="btn" href="#" data-dismiss="modal"
		aria-hidden="true">Annuler</a>-->
</div>
