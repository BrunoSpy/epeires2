
<div class="warnings">
<?php if (isset($this->messages['successMessages'])) { ?>
	<?php foreach ($this->messages['successMessages'] as $message) { ?>
		<div class="alert alert-success">
			<a class="close" data-dismiss="alert" href="#">&times;</a>
			<?php echo $message ?>
		</div>
	<?php }?>
<?php } ?>

<?php if (isset($this->messages['errorMessages'])) { ?>
	<?php foreach ($this->messages['errorMessages'] as $message) { ?>
		<div class="alert alert-error">
			<a class="close" data-dismiss="alert" href="#">&times;</a>
			<?php echo $message ?>
		</div>
	<?php }?>
<?php } ?>
</div>

<div id="create-evt">
<?php 
	echo $this->partial('events/form.phtml');
?>
</div>
<div id="list-events">
<table>
<tbody>
<?php 
	foreach ($this->events as $event){
		echo "<tr>";
		echo "<td>";
		if($event->getImpact()){
			echo "<span class=\"label label-".$event->getImpact()->getStyle()."\">";
			echo $event->getImpact()->getName()."</span>";
		}
		echo "</td>";
		echo "<td>".$event->getName()."</td>";
		echo "<td><a id=\"modify-evt\" href=\"#\" class=\"btn\" data-id=\"".$event->getId()."\" >Modifier</a></td>";
		echo "</tr>";
	}
?>
</tbody>
</table>

</div>

<?php $this->inlineScript()->captureStart();?>

$(document).on("click", "a#modify-evt", function(){
	$("#event").html('<div id="loading">Chargement...</div>');
	$("#create-evt").show();
	$("#event").load(
		'<?php echo $this->url('application', array('controller'=>'events', 'action' =>'createform'))?>'+'?type=modification&id='+$(this).data('id'),
		function(){

		}
	);
});
<?php $this->inlineScript()->captureEnd();?>
