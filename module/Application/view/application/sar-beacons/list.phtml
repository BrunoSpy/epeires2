<?php
	$class_alert = [
		'INCERFA' => 'info',
		'ALERFA' => 'warning',
		'DETRESFA' => 'danger'
	];
?>

<?php $i = 0; ?>
<?php foreach ($intPlans as $ip) : ?>
<?php 
    $typealert = (isset($ip['Alerte']['Type'])) ? $ip['Alerte']['Type'] : null;
?>
<a data-id="<?php echo $ip['id']; ?>" class="list-group-item list-group-item-<?php echo (array_key_exists($typealert, $class_alert)) ? $class_alert[$typealert] : 'primary'; ?>">
    <h1 class="list-group-item-heading"><?php echo $ip['start_date']->format('d-m-Y H:i:s') ?></h1>
    <div class = "list-ip-content <?php echo ($i>0)?'cache':''; ?>">
        <p class="list-group-item-text">Latitude: <?php echo $ip['Latitude']?></p>
        <p class="list-group-item-text">Longitude: <?php echo $ip['Longitude']?></p>
        <p class="list-group-item-text">Type : <?php echo $ip['Type']?></p>
		<p class="list-group-item-text">Alerte : <?php echo (isset($typealert)) ? $typealert : NIL; ?></p>
        <!-- <h3 class="list-group-item-heading">Alerte</h3> -->
        <p class="list-group-item-text comment">Cause : <?php echo (isset($ip['Alerte']['Cause'])) ? $ip['Alerte']['Cause'] : null; ?></p>


        <?php if (isset($ip['fields'])) : ?> 
            <h3 class="list-group-item-heading">Terrains interrog√©s</h3>
            <?php foreach ($ip['fields'] as $i => $f) : ?> 
                <h4 class="list-group-item-heading">#<?php echo $i++?> <?php echo $f['Nom'];?> [<?php echo $f['start_date']->format('H:i:s');?>]</h4>
                <?php if (isset($f['updates'])) : ?>
                    <?php foreach($f['updates'] as $updates) :?>
                    <p class="list-group-item-text comment"><?php echo $updates['text'];?></p>
                    <?php endforeach; ?>
                <?php endif; ?>
            <?php endforeach; ?>
        <?php endif; ?>
        
        <button href="#mdl-start-ip" data-toggle="modal" class = "btn btn-sm btn-primary btn-edit-ip">
        <!-- <span class="glyphicon glyphicon-pencil"></span> -->
        Modifier
        </button>

        <button class = "btn btn-sm btn-primary btn-print-ip">
        <!-- <span class="glyphicon glyphicon-pencil"></span> -->
        Imprimer
        </button>

        <button class = "btn btn-sm btn-primary btn-print-ip">
        <!-- <span class="glyphicon glyphicon-pencil"></span> -->
        Courriel
        </button>

    </div>
</a>
<?php $i++; ?>
<?php endforeach; ?>
    // echo $this->sbViewHelper()->renderIp($iP);

